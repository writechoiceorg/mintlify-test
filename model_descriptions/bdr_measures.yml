version: 2

models:
  - name: bdr_measures
    config:
      tags: [ 'bdr' ]
      frequencyDomain: 'BINDERY'
    data_tests:
      - not_empty:
          meta:
            requirement: ['FDR-1402']
      - has_rls:
          meta:
            requirement: [ 'ETL-1630' ]

    columns:
      - name: memberid
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-1402' ]
      - name: personid
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-1402' ]
      - name: MeasureUniqueName
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2059' ]
      - name: periodName
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2060' ]
      - name: periodType
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2060' ]
