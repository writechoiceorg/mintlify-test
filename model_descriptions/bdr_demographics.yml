version: 2

models:
  - name: bdr_demographics
    config:
      tags: ['bdr']
      frequencyDomain: 'BINDERY'
    data_tests:
      - not_empty:
          meta:
            requirement: [ 'FDR-1386' ]
      - has_rls:
          meta:
            requirement: [ 'ETL-1630' ]
    columns:
      - name: personId
        description: >
          Arcadia's universal identifier for the patient/member record. This
          identifier is subject to change over time.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-1386' ]
      - name: name
        description: >
          The patient's full name (Last, First).
      - name: MRN
        description: >
          The patients MRN(s).
      - name: memberNo
        description: >
          If a plan record exists, the payer-supplied member identifier for the
          most recent eligibility record.
      - name: activeInd
        description: >
          A Y/N indicator that the person is considered "Active" based on
          indications in the EHR and the recency of past utilization.
      - name: DOB
        description: >
          The person's date of birth.
      - name: deathDate
        description: >
          If available and relevant, the person's death date.
      - name: age
        description: >
          The person's age (as of last data load).
      - name: sex
        description: >
          The person's sex.
      - name: phone
        description: >
          The primary phone on the most recently updated patient record.
      - name: email
        description: >
          If available, the most recently added email address for the patient.
      - name: address1
        description: >
          If available, the most recently added street address for the patient.
      - name: address2
        description: >
          If available, the most recently added second street address for the
          patient.
      - name: city
        description: >
          If available, the most recently added City for the patient.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2062' ]
      - name: state
        description: >
          If available, the most recently added State for the patient.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2062' ]
      - name: ZIP
        description: >
          If available, the most recently added Zip for the patient.
      - name: GeoID
        description: >
          The geocoded US Census Tract for the patient's address.
      - name: censusBlock
        description: >
          The geocoded US Census Block for the patient's address used to map
          to certain ACS variables or other GIS data.
      - name: latitude
        description: >
          The geocoded latitude of the patient's address.
      - name: longitude
        description: >
          The geocoded longitude of the patient's address.
      - name: race
        description: >
          The person race (if available, from the EHR and claims sources).
      - name: ethnicity
        description: >
          The person ethnicity (if available, from the EHR and claims sources).
      - name: Language
        description: >
          The person language (if available, from the EHR and claims sources).
      - name: pcpNPI
        description: >
          The NPI of the attributed PCP in the given month.
      - name: pcpName
        description: >
          The full name of the attributed PCP in the given month.
      - name: pcpGrouper1
        description: >
          The health system-defined first-level of the attributed PCP in
          the given month. This could be a practice, medical group,
          department, etc.
      - name: pcpGrouper2
        description: >
          The health system-defined second-level grouper of the
          attributed PCP in the given month. This may be an ACO,
          region or market, or pod.
      - name: pcpGrouper3
        description: >
          The health system -defined Risk Unit of the attributed PCP in
          the given month. This may be an ACO, region or market, or
          pod.
      - name: pcpGrouper4
        description: >
          Additional groupers or provider attributes, as needed.
      - name: pcpGrouper5
        description: >
          Additional groupers or provider attributes, as needed.
      - name: pcpGrouper6
        description: >
          Additional groupers or provider attributes, as needed.
      - name: planPayer
        description: >
          The Payer for which the person is eligible in the given month.
      - name: planProduct
        description: >
          The Product for which the person is eligible in the given
          month. This corresponds to the LOB in the connector spec.
      - name: planFundingSource
        description: >
          If applicable, the Funding Source for which the person is
          eligible in the given month. This corresponds to the product
          in the connector spec.
      - name: atRiskFlag
        description: >
          A 0/1 indicator that, in the given month, this member is
          considered "At Risk" for a payer contract. This column can be
          summed to generate aggregate numbers of at-risk patients,
          or used as a filter.
