version: 2

models:
  - name: personMeasureEvidence
    description: > 
      This table surfaces the supporting evidence, if available, for specified quality measures enabled in Analytics. As available, there is one evidential event per person/period/measure/measure component. 
      In the case of multiple events qualifying the person for the measure component, the event with the most recent service date is surfaced. 

      Contain the results of all quality measures enabled in Analytics. The [personMeasures] view
      contains one record per person/period/measure for the entire population, while the [personMeasuresContract] table
      contains one record per person/payer/measure for each year period in which a person was enrolled with a plan.
      ote the “person” is the post-MPI record, so it is possible that these results contain data from multiple member
      records (duals or churn) and multiple patient records (specialty/hospital and primary care) per person. Note the
      Denominator and Numerator fields contain more detailed breakouts, with Exclusions and Exceptions called out
      separately
    config:
      tags: [ 'care_quality_and_program_data' ]
    data_tests:
      - has_rls:
          meta:
            requirement: [ 'FDR-1514' ]

    columns:
      - name: PersonId
        description: >
          Arcadia's universal identifier for the patient/member
          record. This identifier is subject to change over time.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-745' ]
          - relationships:
              to: ref('v_patient')
              field: person_id
              meta:
                requirement: [ 'FDR-745' ]
      - name: InitiativeId
        description: >
          Arcadia's internal identifier for the initiative that
          contains the given measure.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-745' ]
          - relationships:
              to: source('staging', 'qdw_web_Initiative')
              field: InitiativeID
              meta:
                requirement: [ 'FDR-745' ]
      - name: MeasureId
        description: >
          Arcadia's internal identifier for the given measure.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-745' ]
          - relationships:
              to: ref('web_InitiativeMeasure')
              field: measureId
              meta:
                requirement: [ 'FDR-745' ]
      - name: InitiativeName
        description: >
          The name of the initiative that contains the given
          measure as it appears in the Arcadia Analytics front
          end.
      - name: MeasureDisplayName
        description: >
          The name of the given measure as it appears in the
          Arcadia Analytics front end.
      - name: MeasureDescription
        description: >
          The description that appears when hovering over the
          given measure in the Arcadia Analytics front end.
      - name: PeriodName
        description: >
          The period for which the measure evidence values are
          captured.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-745' ]
          - relationships:
              to: ref('rpt_period')
              field: name
              meta:
                requirement: [ 'FDR-745' ]
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2060' ]
      - name: PeriodType
        description: >
          The type of period for which the measure evidence
          values are captured
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2060' ]
      - name: PeriodStart
        description: >
          The first day of the calculated period.
      - name: PeriodEnd
        description: >
          The last day of the calculated period.
      - name: measureComponent
        description: >
          Component of the measure the measure event
          provides evidence for.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2060' ]
      - name: eventType
        description: >
          Type of event substantiating the measure evidence.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2060' ]
      - name: eventDate
        description: >
          Date of the event substantiating the measure
          evidence.
      - name: eventValue
        description: >
          If available, value of the event substantiating the
          measure evidence.
      - name: eventCode
        description: >
          Code of event substantiating the measure evidence.
      - name: eventProviderNPI
        description: >
          The NPI of the provider attributed to the measure
          evidence event.
      - name: eventProviderSpecialty
        description: >
          The specialty of the provider attributed to the
          measure evidence event.
      - name: eventDataSource
        description: >
          Data source of the event substantiating the measure evidence.
      - name: periodId
        description: >
          A numeric identifier of the relevant time period for a measure.
      - name: asOf
        description: >
          Date of last execution when the table was calculated.
      - name: loadDate
        description: >
          Date the table containing measure evidence was loaded to the data lake.
      - name: eventEndDate
        description: >
          Date of the event substantiating the measure
          evidence.