version: 2

models:
  - name: v_plan_member_address
    description: >
     This table contains addresses for plan members. This information is used in the MPI member-patient matching process as well as for geographic analyses and member outreach purposes. A member can have multiple rows in this table, because each row is distinguished by start and end dates as well as by address type.

    columns:
      - name: person_id
        description: >
          QDW person ID for the member.
      - name: member_address_id
        description: >
           QDW member address ID; primary key for this table.  This is generated by Arcadia.
      - name: member_id
        description: >
          QDW member ID; primary key for this table.  This is generated by Arcadia.
      - name: orig_member_id
        description: >
           Member ID, as specified in the plan data source, of the member with whom this address is associated.  
      - name: attention
        description: >
           Attention Line (Header for letters).
      - name: address_type_unscrubbed
        description: >
           The type of address, as specified in the plan data source.  This value is scrubbed into the address_type column.
      - name: address_type
        description: >
           Code indicating the type of address.  Possible values are 'Mailing' and 'Residential'.   However, since the MPI matching logic only considers mailing addresses, this value must equal 'Mailing' in order for the member's address to be used as a matching criterion.  This value is derived from the value in address_type_unscrubbed based on mapping in the lookup.plan_address_type table in Staging.
      - name: address_line1
        description: >
           Address line 1.
      - name: address_line2
        description: >
           Address line 2.
      - name: city
        description: >
           City.  This value, from rows where the address_type is 'Mailing', is used in the Master Patient Index matching process.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2062' ]
      - name: state
        description: >
           US state code.  Two letter code, for example 'MA'.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2062' ]
      - name: zip
        description: >
           Zip code.  This may be a 5-digit zip or zip+4.  For zip+4 values, the hyphen is usually included, but is not required.  The first 5 digits of this value, from rows where the address_type is 'Mailing', are used in the Master Patient Index matching process.
      - name: county_unscrubbed
        description: >
           County name, as specified in the plan data source. This value is scrubbed into the county column.
      - name: county
        description: >
           County name. This value is derived the the value in county_unscrubbed based on mapping in the lookup.plan_county table in Staging.  Not generally populated.
      - name: country
        description: >
           Country code.  When this value is null, USA is assumed.
      - name: longitude
        description: >
           Address longitude.
      - name: latitude
        description: >
           Address latitude.
      - name: start_date_unscrubbed
        description: >
           Address effective date, as specified in the plan data source.
      - name: start_date
        description: >
           Address effective date.
      - name: end_date_unscrubbed
        description: >
           Address termination date, as specified in the plan data source.
      - name: end_date
        description: >
           Address termination date.
      - name: orig_member_address_id
        description: >
           ID of the member address row in the Staging database, used to tie back to the plan data source.  This is created by the connector query or direct feed that loads the row from a given source, and is derived from plan data source column(s) to uniquely identify a row. For a given source, one original ID corresponds to one and only one QDW ID for this entity.  The same original ID value could be found on more than one row if the rows are derived from different sources.
      - name: orig_source_id
        description: >
           QDW source ID in character format of the plan data source from which this record was obtained.
      - name: source_id
        description: >
           QDW source ID of the plan data source from which this record was obtained.
      - name: insert_timestamp
        description: >
           Date and time when the row was first inserted into the QDW.
      - name: update_timestamp
        description: >
           Date and time when the row was last updated in the QDW.
      - name: create_timestamp
        description: >
           Date and time when the row was first inserted into the plan data source.
      - name: modify_timestamp
        description: >
           Date and time when the row was last updated in the plan data source.
      - name: created_by
        description: >
           User who first inserted the row into the plan data source, as specified by a user ID known to the plan data source.
      - name: modified_by
        description: >
           User who most recently updated the row in the plan data source, as specified by a user ID known to the plan data source.
      - name: delete_ind
        description: >
           Indicates if the record is marked as deleted, either because it was deleted in the plan data source, or because the connector query changed in a way that makes the record no longer valid.  Values are Y (deleted) and N (not deleted).  If the value is 'Y' then the row should be excluded from all queries.
      - name: loaded_from_file
        description: >
           Name of the file from which this particular record was first loaded, usually a CSV file. The following pieces of information may be embedded in this file name: date and time of the extract, client and source IDs, and connector query version.  