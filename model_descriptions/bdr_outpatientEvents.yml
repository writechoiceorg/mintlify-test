version: 2

models:
  - name: bdr_outpatientEvents
    config:
      tags: [ 'bdr' ]
      frequencyDomain: 'BINDERY'
    data_tests:
      - not_empty:
          meta:
            requirement: [ 'FDR-1401' ]
      - has_rls:
          meta:
            requirement: [ 'ETL-1630' ]

    columns:
      - name: eventId
        description: >
          The Arcadia internal ID of the outpatient event, which
          can be mapped to contributing line events in
          [dbo].[eventLineDetails] with rollupEventId. This
          identifier is subject to change over time.
      - name: memberId
        description: >
          Arcadia internal member identifier, which can be used to
          join to raw plan views or [dbo].[personAttribution]. This
          identifier is subject to change over time.
      - name: personId
        description: >
          Arcadia's universal identifier for the patient/member
          record. This identifier is subject to change over time.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-1401' ]
          - relationships:
              to: ref('v_patient')
              field: person_id
      - name: memberNo
        description: >
          The payer-supplied member identifier.
      - name: planPayer
        description: >
          The payer on the claim.
      - name: eventDate
        description: >
          Date of the outpatient service.
      - name: admitDate
        description: >
          Arcadia's  admit  date,  if  applicable  after  running  an
          Observation stay chaining ruleset. Only events with the
          Observation event grouper are candidates for chaining.
      - name: dischargeDate
        description: >
          Arcadia's discharge date, if applicable after running an
          Observation stay chaining ruleset. Only events with the
          Observation event grouper are candidates for chaining.
      - name: LOS
        description: >
          The length of the Observation stay in days, if applicable.
      - name: paidDate
        description: >
          The paid date from the claim header.
      - name: monthsRunout
        description: >
          Claims lag: months between the maximum paid date of
          claims from this payer and the event date.
      - name: rptGrouper
        description: >
          Arcadia's reporting grouper.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2063' ]
      - name: rptGrouper2
        description: >
          Optional lower-level reporting groups.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2063' ]
      - name: rptGrouper3
        description: >
          Optional lower-level reporting groups.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2063' ]
      - name: claimHeaderId
        description: >
          The claim header ID for the stay. See Outpatient Event
          Details for rules on how this is determined.
      - name: cost
        description: >
          The contractual reconciliation amount for the event.
          This field surfaces the highest priority payer product
          configured cost value for the event, in order of stop loss
          cost, at risk event cost, and then cost of care.
      - name: costOfCare
        description: >
          The cost of care for the event, typically the insurer's Paid
          Amount though will vary by contract.
      - name: riskAdjustedCost
        description: >
          Costs adjusted for the patients acuity score. Note: This
          should ONLY be used for aggregate reporting, not
          analysis of a single event.
      - name: costFacility
        description: >
          The sum of all costs from facility charges for the stay.
      - name: costProfessional
        description: >
          The sum of all costs from professional charges for the
          stay.
      - name: costOther
        description: >
          The sum of all other/ancillary charges for the stay.
      - name: costIBNR
        description: >
          A cost calculation applying an IBNR model. While not
          relevant as an individual line, this can be used to roll up
          costs with IBNR in aggregate.
      - name: placeOfService
        description: >
          The most relevant POS code. See Outpatient Event
          Details for rules on how this is determined.
      - name: placeOfServiceDescription
        description: >
          Text description of the most relevant POS code. See
          Outpatient Event Details for rules on how this is
          determined.
      - name: revenueCode
        description: >
          The most relevant Revenue code. See Outpatient Event
          Details for rules on how this is determined.
      - name: revenueCodeDescription
        description: >
          Text description of the most relevant Revenue code. See
          Outpatient Event Details for rules on how this is
          determined.
      - name: cpt
        description: >
          The most relevant CPT code. See Outpatient Event
          Details for rules on how this is determined.
      - name: cptDescription
        description: >
          Text description of the most relevant CPT code. See
          Outpatient Event Details for rules on how this is
          determined.
      - name: ccsCptMinor
        description: >
          Low-level AHRQ CCS grouping of relevant CPT code.
      - name: ccsCptMajor
        description: >
          High-level AHRQ CCS grouping of relevant CPT code.
      - name: icd
        description: >
          The most relevant ICD code. See Outpatient Event
          Details for rules on how this is determined.
      - name: icdCodeSet
        description: >
          Version of ICD code set for relevant ICD code.
        data_tests:
          - column_values_are_in_uppercase:
              meta:
                requirement: [ 'FDR-2063' ]
      - name: icdDescription
        description: >
          Text description of the most relevant ICD code. See
          Outpatient Event Details for rules on how this is
          determined.
      - name: ccsDxMinor
        description: >
          Low-level AHRQ CCS grouping of relevant ICD code.
      - name: ccsDxMajor
        description: >
          High-level AHRQ CCS grouping of relevant ICD code.
      - name: acgEdcMinor
        description: >
          The ACG Expanded Diagnosis Cluster (EDC) code that
          categorize cases with similar diseases or conditions that
          are treated in ambulatory and inpatient settings.
      - name: acgEdcMajor
        description: >
          The ACG Major Expanded Diagnoses Cluster (MEDC)
          code assigned to this patient. The EDC taxonomy is
          structured into broad clinical categories called MEDCs.
      - name: providerName
        description: >
          Most relevant provider name. See Outpatient Event
          Details for rules on how this is determined.
      - name: providerNPI
        description: >
          NPI of provider.
      - name: providerSpecialty
        description: >
          Specialty of provider, from NPPES.
      - name: providerGrouper1
        description: >
          Up to 6 "grouper" attributes of the provider (e.g.,
          "Practice", "Pod", "Market").
      - name: providerGrouper2
        description: >
          Up to 6 "grouper" attributes of the provider (e.g.,
          "Practice", "Pod", "Market").
      - name: providerGrouper3
        description: >
          Up to 6 "grouper" attributes of the provider (e.g.,
          "Practice", "Pod", "Market").
      - name: providerGrouper4
        description: >
          Up to 6 "grouper" attributes of the provider (e.g.,
          "Practice", "Pod", "Market").
      - name: providerGrouper5
        description: >
          Up to 6 "grouper" attributes of the provider (e.g.,
          "Practice", "Pod", "Market").
      - name: providerGrouper6
        description: >
          Up to 6 "grouper" attributes of the provider (e.g.,
          "Practice", "Pod", "Market").
      - name: inNetwork
        description: >
          A 0/1 indicator that the event is in Network.
      - name: inTier1
        description: >
          A 0/1 indicator that the event is in a Tier 1 Preferred
          Network.
      - name: inTier2
        description: >
          A 0/1 indicator that the event is in a Tier 2 Preferred
          Network.
      - name: inTier3
        description: >
          A 0/1 indicator that the event is in a Tier 3 Preferred
          Network.
      - name: inNetworkFacility
        description: >
          A 0/1 indicator that the Service Facility on the event was
          considered "In Network" at the time of the event.
      - name: inNetworkProvider
        description: >
          A 0/1 indicator that the Provider on the event was
          considered "In Network" at the time of the event.
      - name: serviceFacility
        description: >
          Most  relevant  service  facility.  See  Outpatient Event
          Details for rules on how this is determined.
      - name: serviceFacilityNPI
        description: >
          NPI of service facility.
      - name: serviceFacilityGrouper1
        description: >
          Up to 6 "grouper" attributes of the service facility (e.g.,
          "Practice", "Pod", "Market").
      - name: serviceFacilityGrouper2
        description: >
          Up to 6 "grouper" attributes of the service facility (e.g.,
          "Practice", "Pod", "Market").
      - name: serviceFacilityGrouper3
        description: >
          Up to 6 "grouper" attributes of the service facility (e.g.,
          "Practice", "Pod", "Market").
      - name: serviceFacilityGrouper4
        description: >
          Up to 6 "grouper" attributes of the service facility (e.g.,
          "Practice", "Pod", "Market").
      - name: serviceFacilityGrouper5
        description: >
          Up to 6 "grouper" attributes of the service facility (e.g.,
          "Practice", "Pod", "Market").
      - name: serviceFacilityGrouper6
        description: >
          Up to 6 "grouper" attributes of the service facility (e.g.,
          "Practice", "Pod", "Market").
      - name: distance
        description: >
          The distance between the member's place of residence
          and the facility, in miles.
      - name: edAvoidableInd
        description: >
          A 0/1 indicator that the ED event qualifies for the NYU
          Avoidable ED category. Will be empty if the event is not
          an ED event.
      - name: ascInd
        description: >
          A 0/1 indicator that the event meets CMS Ambulatory
          Sensitive Conditions (ASC) admission criteria.
      - name: pcpNPI
        description: >
          The PCP that the member was assigned to at the time
          of this event. In financial reporting, the cost will be rolled
          up to this PCP.
      - name: pcpName
        description: >
          The name of the assigned PCP.
      - name: pcpGrouper1
        description: >
          Up to 6 "grouper" attributes of the PCP (e.g., "Practice",
          "Pod", "Market”).
      - name: pcpGrouper2
        description: >
          Up to 6 "grouper" attributes of the PCP (e.g., "Practice",
          "Pod", "Market”).
      - name: pcpGrouper3
        description: >
          Up to 6 "grouper" attributes of the PCP (e.g., "Practice",
          "Pod", "Market”).
      - name: pcpGrouper4
        description: >
          Up to 6 "grouper" attributes of the PCP (e.g., "Practice",
          "Pod", "Market”).
      - name: pcpGrouper5
        description: >
          Up to 6 "grouper" attributes of the PCP (e.g., "Practice",
          "Pod", "Market”).
      - name: pcpGrouper6
        description: >
          Up to 6 "grouper" attributes of the PCP (e.g., "Practice",
          "Pod", "Market”).
      - name: planProduct
        description: >
          The insurance Product the patient was eligible for
          during the visit.
      - name: planFundingSource
        description: >
          The insurance Funding Source or business line
          associated to that eligibility.
      - name: claimAtRisk
        description: >
          A 0/1 indicator that the event should be considered in
          financial reporting on the risk-based contract. When
          both the claimant and the service are "at-risk" this is 1.
      - name: claimMemberAtRisk
        description: >
          A 0/1 indicator that the claimant is in a risk contract
          during the event.
      - name: claimServiceAtRisk
        description: >
          Same definition as claimAtRisk.
      - name: providerTIN
        description: >
          The Federal Tax Identification Number of the provider,
          if applicable.
      - name: providerCCN
        description: >
          The CMS Certification Number of the facility, if
          applicable.
      - name: sensitiveInd
        description: >
          A 0/1 indicator that the event is a sensitive claim.
      - name: planContract
        description: >
          The payer on the claim.
      - name: careSetting
        description: >
          Not Available
      - name: rls_planSource
        description: >
          Not Available
      - name: rls_provider
        description: >
          Not Available
      - name: rls_providerGrouper1
        description: >
          Not Available
      - name: rls_providerGrouper2
        description: >
          Not Available
      - name: rls_providerGrouper3
        description: >
          Not Available
      - name: yearMonth
        description: >
          Not Available
      - name: awvInd
        description: >
          A 0/1 indicator that the event is an Annual Wellness Visit.
          Arcadia uses these CPT codes to identify AWVs: G0402, G0438, G0439, G0468.
      - name: tcmInd
        description: >
          A 0/1 indicator that the event is a Transitional Care Management visit.
          Arcadia uses these CPT codes to identify TCM visits: 99495, 99496.
      - name: acpInd
        description: >
          A 0/1 indicator that the event has a CPT code of advanced care planning.
          Arcadia uses these CPT codes to identify ACP visits: 99497, 99498.
      - name: fyStartDate
        description: >
          The start date of the financial year the event occurs in.
      - name: fyEndDate
        description: >
          The end date of the financial year the event occurs in.
      - name: fyIndex
        description: >
          The index of the financial year the event occurs in. A '0'
          indicates the event is contained in the current financial year.
      - name: telehealthInd
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-1401' ]
          - accepted_values:
              values: [ 0, 1 ]
        description: >
          A 0/1 flag that indicates one of the event lines on the event has an associated telehealth CPT procedure modifier of ‘95’ or ‘GT’,
          or the ccsCptMinor description is 'telehealth'.
      - name: atRiskAmount
        description: >
          The amount that is considered ‘At Risk’ as configured by member and service 
          line at risk rules after at risk rules have been applied. 
          This amount forms the basis of stop loss cost calculation.
      - name: slProtectedAmount
        description: >
          The amount that is considered stop loss protected after stop loss rules 
          have been applied.
      - name: billingProviderId
        description: >
          Not Available
      - name: billingNPI
        description: >
          Not Available
      - name: billingTIN
        description: >
          Not Available
      - name: imputedReferringProviderPersonID
        description: >
          Not Available
      - name: imputedReferringProviderNPI
        description: >
          Not Available
      - name: newSpecVisitInd
        description: >
          Not Available
      - name: followUpCost90
        description: >
          Not Available
      - name: ascPQIMeasureNumber
        description: >
          Not Available
      - name: ascPQIMeasureName
        description: >
          Not Available
      - name: maxPaid
        description: >
          Max paid date for the source in medical claims.
      - name: edInSNF
        description: >
          A 0/1 flag that indicates whether this event is an ED event that occurs during the timeframe of an inpatient SNF event. 
      - name: obsInSNF
        description: >
          A 0/1 flag that indicates whether this event is an observation event that occurs during the timeframe of an inpatient SNF event. 
