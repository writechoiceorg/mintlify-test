version: 2

models:
  - name: v_plan_member
    description: >
      This table contains demographic information on plan members, including historical
      members as well as members who are currently eligible. Several of these attributes
      are used in patient matching logic that will be used to connect plan and clinical data
      on individuals across data sources.
    data_tests:
      - has_rls:
          meta:
            requirement: ['FDR-1514']
      - not_empty:
          meta:
            requirement: [ 'FDR-1849' ]

    columns:
      - name: person_id
        description: >
          QDW person ID for the member.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-728' ]
          - relationships:
              to: ref('v_patient')
              field: person_id
              meta:
                requirement: [ 'FDR-728' ]
      - name: member_id
        description: >
          QDW member ID; primary key for this table.  This is generated by Arcadia.
      - name: first_name
        description: >
          First name of the member.  This value is used in the Master Patient Index
          matching process.  Some sources append the member's middle initial to the end of
          the first name column.  Ideally, any middle initial should be moved to the
          middle_name column so that the first_name column can be more accurately used by
          the matching algorithm.
      - name: middle_name
        description: >
          Middle name or initial of the member.  This value may be used in the Master
          Patient Index matching process.
      - name: last_name
        description: >
          Last name of the member.  This value is used in the Master Patient Index
          matching process.
      - name: contact_title
        description: >
          Contact title of the member, such as 'Mr.', 'Ms', etc.
      - name: sex_unscrubbed
        description: >
          Gender of the member, as specified in the plan data source.  This value is
          scrubbed into the sex column.
      - name: sex
        description: >
          Gender of the member.  Valid values are 'M' (Male), 'F' (Female), 'O' (Other;
          used for transgender or other distinctions) and 'U' (Unknown).  This value is
          derived from the value in sex_unscrubbed based on mapping in the lookup.plan_sex
          table in Staging.  This value is used in the Master Patient Index matching
          process.
      - name: home_phone
        description: >
          Primary phone number of the member.  This may be formatted either with or
          without hyphens and parentheses.  This value is used in Care Management
          functionality, and may be used in the Master Patient Index matching process.
      - name: business_phone
        description: >
          Business phone number of the member.  This may be formatted either with or
          without hyphens and parentheses.
      - name: cell_phone
        description: >
          Cell phone number of the member.  This may be formatted either with or without
          hyphens and parentheses.  This is used in the pseudo-claims extract.
      - name: dob
        description: >
          Date of birth of the member.  This value is used in the Master Patient Index
          matching process.
      - name: death_date
        description: >
          Date of death of the member, if the member is deceased.
      - name: head_of_household_name
        description: >
          Name of the head of the household in which the member resides.
      - name: pregnancy_date
        description: >
          Pregnancy date.
      - name: first_covered_date
        description: >
          First covered date, the date and time when the member was first enrolled in the
          plan.  Typically the time information is all zeroes.
      - name: special_needs_unscrubbed
        description: >
          Indicates if the member has special needs, as specified in the plan data source.
          This value is scrubbed into the special_needs column.
      - name: special_needs
        description: >
          Indicates if the member has special needs. This value is derived from the
          special_needs_unscrubbed column based on mapping in the
          lookup.plan_special_needs table in Staging.  Arcadia has not defined a list of
          valid codes for this column.  It may be populated in whatever way is useful to
          the client.
      - name: individual_no
        description: >
          Individual number of the member.  Alternate member id from the plan data source.
          This value is not necessarily unique for each member.
      - name: language_unscrubbed
        description: >
          Primary language of the member, as specified in the plan data source.  This
          value is scrubbed into the language column.
      - name: language
        description: >
          Primary language of the member.  This value is derived from language_unscrubbed
          based on mapping in the lookup.plan_language table in Staging.
      - name: risk_unscrubbed
        description: >
          Risk score assigned to the member, as specified in the plan data source.  This
          value is scrubbed into the risk column.
      - name: risk
        description: >
          Risk score that the plan assigned to the member.  This value is populated in
          cases where the payer assigns risk scores to members based on its own risk
          algorithm and chooses to have them reflected in the Arcadia warehouse.  This
          value is derived from the value in risk_unscrubbed.  Note that this is NOT the
          risk score calculated by the Arcadia risk scoring algorithm such as CDPS or HCC.
      - name: marital_status_unscrubbed
        description: >
          Member marital status, such as single, married, divorced,etc., as specified in
          the plan data source.  This value is scrubbed into the marital_status column.
      - name: marital_status
        description: >
          Member marital status, such as single, married, divorced,etc., as specified in
          the plan data source.  This value is derived from the marital_status_unscrubbed
          column based on mapping in the lookup.plan_marital_status table in Staging.
          Arcadia has not defined a list of valid codes for this column.  It may be
          populated in whatever way is useful to the client.
      - name: ssn
        description: >
          Social Security Number of the member.  This value is used in the Master Patient
          Index matching process.  The value is stored as 9 numeric digits, either with or
          without hyphens.
      - name: relationship_unscrubbed
        description: >
          Relationship of the member to the person who is the subscriber named in the
          health insurance coverage, as specified in the plan data source.  This value is
          scrubbed into the relationship column.
      - name: relationship
        description: >
          Relationship of the member to the person who is the subscriber named in the
          health insurance coverage.  Example values are 'Child', 'Spouse', 'Subscriber'.
          This value is derived from relationship_unscrubbed based on mapping in the
          lookup.plan_relationship table in Staging.  Arcadia has not defined a list of
          valid codes for this column.  It may be populated in whatever way is useful to
          the client.
      - name: ethnicity_unscrubbed
        description: >
          Member's ethnicity, as specified in the plan data source.  This value is
          scrubbed into the ethnicity column.
      - name: ethnicity
        description: >
          Member's ethnicity.  Valid values are 'Hispanic or Latino', 'Not Hispanic or
          Latino', 'Other' and 'Unreported/Refused to report'.  This value is derived from
          the value in ethnicity_unscrubbed using mappings found in Staging table
          lookup.plan_ethnicity.
      - name: race_unscrubbed
        description: >
          Member's race, as specified in the plan data source.  This value is scrubbed
          into the race column.
      - name: race
        description: >
          Member's race.  Valid values are 'White', 'Black or African American', 'American
          Indian or Alaska Native',  'Asian', 'Native Hawaiian or Other Pacific Islander',
          'More than one race', 'Other' and 'Unreported/Refused to report' .  This value
          is derived from the value in race_unscrubbed, using mappings found in Staging
          table lookup.plan_race.
      - name: medicaid_id
        description: >
          Member's Medicaid ID.  Most valid Medicaid IDs take the format of 9 numeric
          digits followed by two alpha characters, where the two alpha characters are
          generally a state code such as 'WA'.  This value may be used in the Master
          Patient Index matching process.
      - name: medicare_id
        description: >
          Member's Medicare ID, also referred to as HICN (Medicare Health Insurance Claim
          Number).  Most valid Medicare IDs take the format of 9 numeric digits followed
          by one or sometimes two alphanumeric characters.  The 9 digits, referred to as
          the Claim Account Number, represent the policy number of the wage earner who
          earned Medicare benefits.  The one or two characters that follow, referred to as
          the Beneficiary Identification Code, represent a descriptor of the member's
          category, for example 'A' (Primary claimant), 'B' (Spouse), 'C1' (Child), 'D6'
          (Surviving Divorced Wife, age 60 or over).  In cases where the Beneficiary
          Identification Code is 'A', the first 9 digits generally represent the member's
          Social Security Number (except in rare cases where the number is generated
          through the Railroad Retirement Board).  Note that the Medicare ID of an
          individual member can change over time, for example when the member's
          relationship to the wage earner changes, such as from wife to widow.  It can
          also change when a member shifts from receiving benefits under their own account
          to receiving benefits through a spouses' account.  This value may be used in the
          Master Patient Index matching process.
      - name: orig_source_id
        description: >
          QDW source ID in character format of the plan data source from which this record
          was obtained.
      - name: source_id
        description: >
          QDW source ID of the plan data source from which this record was obtained.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-728' ]
          - relationships:
              to: ref('v_plan_source')
              field: source_id
              meta:
                requirement: [ 'FDR-728' ]
      - name: orig_member_id
        description: >
          ID of the member row in the Staging database, used to tie back to the plan data
          source.  This is created by the connector query or direct feed that loads the
          row from a given source, and is derived from plan data source column(s) to
          uniquely identify a row. For a given source, one original ID corresponds to one
          and only one QDW ID for this entity.  The same original ID value could be found
          on more than one row if the rows are derived from different sources.
      - name: insert_timestamp
        description: >
          Date and time when the row was first inserted into the QDW.
      - name: update_timestamp
        description: >
          Date and time when the row was last updated in the QDW.
      - name: create_timestamp
        description: >
          Date and time when the row was first inserted into the plan data source.
      - name: modify_timestamp
        description: >
          Date and time when the row was last updated in the plan data source.
      - name: created_by
        description: >
          User who first inserted the row into the plan data source, as specified by a
          user ID known to the plan data source.
      - name: modified_by
        description: >
          User who most recently updated the row in the plan data source, as specified by
          a user ID known to the plan data source.
      - name: delete_ind
        description: >
          Indicates if the record is marked as deleted, either because it was deleted in
          the plan data source, or because the connector query changed in a way that makes
          the record no longer valid.  Values are 'Y' (deleted) and 'N' (not
          deleted).  If the value is 'Y' then the row should be excluded from all queries.
      - name: loaded_from_file
        description: >
          Name of the file from which this particular record was first loaded, usually a
          CSV file. The following pieces of information may be embedded in this file name:
          date and time of the extract, client and source IDs, and connector query
          version.
      - name: medicaid_renewal_date
        description: >
          Date on which the member is next due to renew their Medicaid eligibility.  Is
          relevant only for Medicaid members and is generally null.
      - name: email_address
        description: >
          Email Address of the member. 