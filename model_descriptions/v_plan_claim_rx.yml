version: 2

models:
  - name: v_plan_claim_rx
    data_tests:
      - not_empty:
          meta:
            requirement: [ 'FDR-1849' ]
    description: > 
        This table contains prescription claim information, including comprehensive information on the prescription, as well as information on the method and cost of the prescription fill. Note that each row in this table represents a distinct and complete pharmacy claim. Unlike medical claims, which have both header and line components stored in separate tables, pharmacy claims are stored in a single table.
    columns:
      - name: person_id				
        description: >
          QDW person ID for the patient.       
      - name: claim_rx_id
        description: >
            QDW prescription claim ID; primary key for this table.  This is generated by Arcadia.
      - name: orig_claim_rx_id
        description: >
            ID of the prescription claim row in the Staging database, used to tie back to the plan data source.  This is created by the connector query or direct feed that loads the row from a given source, and is derived from plan data source column(s) to uniquely identify a row. For a given source, one original ID corresponds to one and only one QDW ID for this entity.  The same original ID value could be found on more than one row if the rows are derived from different sources.
      - name: nabp_no
        description: >
            NABP (National Association of Boards of Pharmacy) ID number for the pharmacy that filled the prescription.  Valid IDs are represented as seven numeric digits.  Arcadia does not maintain a list of valid NABP ID numbers.  
      - name: rx_no
        description: >
            Prescription number assigned by the pharmacy.  
      - name: fill_date
        description: >
            Date and time the prescription was filled.  This is the key date column for this entity, and is used to populate the StartDate in the rpt.Event table.  Note that this start_date only refers to this particular fill.  Typically the time information is all zeroes.
      - name: pbm_audit_no
        description: >
            ESI Adjudication Audit Number; the number assigned to the claim by the system at the point of adjudication.  
      - name: adjustment_status
        description: >
            Adjustment status of the prescription claim, indicating whether the prescription claim was approved or denied.  Valid values are 'Approved' (the claim was approved/paid) and 'Denied' (the prescription claim was rejected for some reason such as termination of member eligibility, medication not covered, etc.).  Although Arcadia Analytics does not make use of this data element, denied claims may be ignored in certain ad hoc calculations.  This value is derived from the value in adjustment_status_unscrubbed, using mappings in lookup.plan_adjustment_status in Staging.  If a mapping is not found, the value is set to 'Needs Update'. 
      - name: adjustment_status_unscrubbed
        description: >
            Adjustment status of the prescription claim, as specified in the plan data source.  This value is scrubbed into the adjustment_status column.
      - name: adjudication_date
        description: >
            Date and time the prescription claim was adjudicated.  This is when the plan processed the claim and determined whether it would pay or deny the claim and what amounts it would cover based on the terms of the member's coverage and the plan's contracts with providers. Typically the time information is all zeroes.
      - name: refill_no
        description: >
            The number of times the prescription has been refilled as of this prescription claim.  Values are integers from 0 and higher.  A value of '0' indicates this is a new prescription.  A value of '1' indicates this claim represents the first time the member has refilled the prescription, i.e. the second fill of the prescription.
      - name: drug_strength
        description: >
            Drug strength of the drug that was dispensed.  Values are numeric, and are expressed as the number of units specified in the drug_units column.  
      - name: drug_units
        description: >
            Units in which the drug strength is expressed, for example 'mcg'.  
      - name: quantity
        description: >
            Metric quantity (package size) of the drug dispensed, as specified by the pharmacy (e.g., number of pills, ml of liquids).  However, the quantity units are not specified anywhere and can only be presumed.  For example, if the pharmacy dispenses 100ml, the value would be 100; the 'ml must be presumed.
      - name: days_supply
        description: >
            The number of days the quantity of the drug dispensed is intended to last.  This value is used in calculating the end_date, the last date on which the member presumably was taking this medication. 
      - name: ndc
        description: >
            NDC (National Drug Code) code for the drug that was dispensed.  Valid NDC codes are 11 numeric digits, with leading zeroes.  Generally, the first five digits identify the manufacturer of the drug; the remaining digits, assigned by the manufacturer, identify the drug product (digits 6-9), and quantity (digits 10-11).
      - name: drug_name
        description: >
           Name of the drug that was dispensed. 
      - name: drug_generic_code
        description: >
            Generic drug code, a unique NCHS-assigned, 5-digit code applied to each generic/nonproprietary/active ingredient name.
      - name: drug_product_type_code
        description: >
            Type of drug product.  Often, values in this column distinguish between branded drugs, generic drugs, and medical supplies.  This value is derived from the value in drug_product_type_code_unscrubbed, using mappings in lookup.plan_drug_product_type_code in Staging.  If a mapping is not found, the value is set to 'Needs Update'.  Arcadia has not defined a list of valid codes for this column.  It may be populated in whatever way is useful to the client.
      - name: drug_product_type_code_unscrubbed
        description: >
            Type of drug product, as specified in the plan data source.  This value is scrubbed into the drug_product_type_code column. 
      - name: generic_ind
        description: >
            Indicates if the dispensed drug is a generic drug.  Values are 0 (not a generic) and 1 (generic).  
      - name: dosage_form_code
        description: >
            Code indicating the form of dosage, for example 'TAB' or 'CAP' or 'CREAM'.  This value is derived from the value in dosage_form_code_unscrubbed, using mappings in lookup.plan_dosage_form_code in Staging.  If a mapping is not found, the value is set to 'Needs Update'.  Arcadia has not defined a list of valid codes for this column.  It may be populated in whatever way is useful to the client.
      - name: dosage_form_code_unscrubbed
        description: >
            Code indicating the form of dosage, as specified in the plan data source.  This value is scrubbed into the dosage_form_code column. 
      - name: federal_drug_class_code
        description: >
            Code indicating the federal drug class.  This value is derived from the value in federal_drug_class_code_unscrubbed, using mappings in lookup.plan_federal_drug_class_code in Staging.  These are codes used to identify each of 21 major therapeutic classes (and 139 subclasses) to which a drug may belong (adapted from Standard Drug Classifications in the National Drug Code (NDC) Directory, 1995).  Valid values are four-digit numeric with leading zeroes.  The first two digits indicate the major therapeutic class (e.g., '03' for antimicrobial agents). The full four digits indicate the therapeutic subclasses (e.g., '0346' for penicillin). 
      - name: federal_drug_class_code_unscrubbed
        description: >
            Code indicating the federal drug class, as specified in the plan data source.  This value is scrubbed into the federal_drug_class_code column.  
      - name: formulary_ind
        description: >
           Indicates if the prescription is for a formulary drug.  Values are 0 (non-formulary) and 1 (formulary).
      - name: compound_ind
        description: >
            Indicates if the prescription is for a compound drug.  Values are 0 (non-compound) and 1 (compound).
      - name: daw_code
        description: >
            Code indicating whether the drug was dispensed as written, meaning whether the pharmacist dispensed the exact medication prescribed or substituted an FDA-approved generic medication.  This value is derived from the value in daw_code_unscrubbed, using mappings in lookup.plan_daw_code in Staging.  If a mapping is not found, the value is set to 'Needs Update'.  Arcadia has not defined a list of valid codes for this column.  It may be populated in whatever way is useful to the client.
      - name: daw_code_unscrubbed
        description: >
            Code indicating whether the drug was dispensed as written, as specified in the plan data source.  This value is scrubbed into the daw_code column.
      - name: paid_date
        description: >
            Date and time when the prescription claim was paid.  Typically the time information is all zeroes.
      - name: paid_amount
        description: >
            Amount that the plan paid to the billing provider for this prescription claim, excluding any interest.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: billed_amount
        description: >
            Total amount billed for the prescription claim.  A negative value in this column indicates that this row represents a reversal or negative adjustment. Prescription claims do not always contain billed amount values.
      - name: not_covered_amount
        description: >
            Amount not covered by insurance.  
      - name: deductible_amount
        description: >
            Amount of this prescription claim that was applied to the member's deductible amount.  The overall deductible is a specific dollar amount that the member pays out-of-pocket each year before the health insurance plan begins to make payments for claims.  When a claim is submitted, if the member has not yet satisfied the deductible that year, then the claim will be paid (in part) from the member's deductible, and that amount will be reflected in this column.  Note that some plan data sources do not break down deductible/ copay/ coinsurance amounts and may only specify total member payment.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: coinsurance_amount
        description: >
            Coinsurance amount for this prescription claim.  Coinsurance is the member's share of the costs of a covered medication, calculated as a percentage (for example, 20%) of the allowed amount.  Note that some plan data sources do not break down deductible/ copay/ coinsurance amounts and may only specify total member payment.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  In some client databases, this column is always null.
      - name: copay_amount
        description: >
            Copay amount applied to this prescription claim. The copay is a specific charge that the health insurance plan requires a member to pay for a prescription.  When a claim is submitted, if the member is responsible for a copay for the prescription, then the claim will be paid (in part) from the member's copay, and that amount will be reflected in this column. Note that some plan data sources do not break down deductible/ copay/ coinsurance amounts and may only specify total member payment.  A negative value in this column indicates that this row represents a reversal or negative adjustment. 
      - name: billing_copay_amount
        description: >
            Derived copay amount used in billing and invoicing process.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: passed_copay_amount
        description: >
            Actual amount the member paid at the pharmacy, which may include an ancillary charge and/or deductible amount.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: ancillary_amount
        description: >
            Ancillary amount, a charge in addition to the copay and/or deductible which the member is required to pay for the prescription, e.g. due to a Maximum Allowable Cost (MAC) limit.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: pbm_processing_fee_amount
        description: >
            Administrative fee amount for the claim.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: tax_amount
        description: >
            Sales tax for the prescription based on state/local laws where the pharmacy is located.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: uc_ind
        description: >
            Indicates whether claims are processed as Usual & Customary.  Values are 0 (Not processed as U&C) and 1 (Processed as U&C). 
      - name: uc_amount
        description: >
            Usual and Customary amount for the drug, the amount paid for a medical service in a geographic area based on what providers in the area usually charge for the same or similar medical service.  Usual and customary (U&C) prices reflect the costs of the drugs to the consumer at the retail level without the use of insurance. The U&C rate is often referred to as the 'cash price' for patients, and sometimes is used to determine the allowed amount.
      - name: mac_amount
        description: >
            Maximum Allowable Cost amount of the drug. MAC prices are the upper limits that a pharmacy benefit manager (PBM) or prescription drug benefit plan will pay a pharmacy for generic drugs and brand name drugs that have generic versions available.
      - name: allowed_amount
        description: >
            Amount allowed by the payor, which is the maximum amount on which payment is based for covered health care services. This may be called 'eligible expense,' 'payment allowance' or 'negotiated rate.'  Allowed amounts are generally based on the rate specified by the insurance, such as a fee negotiated with participating providers, an allowance established by law, or an amount set on a Fee Schedule of Allowance.  When a provider submits a bill for more than the allowed amount, the payor bases payment algorithms on the allowed amount rather than the billed amount.  A negative value in this column indicates that this row represents a reversal or negative adjustment. In the absence of an explicitly provided value, this value is the paid amount.
      - name: reimbursement_code
        description: >
            Pricing method used to adjudicate claim; specifies how the Ingredient Cost was determined.  This value is derived from the value in reimbursement_code_unscrubbed, using mappings in lookup.plan_reimbursement_code in Staging.  If a mapping is not found, the value is set to 'Needs Update'.  Arcadia has not defined a list of valid codes for this column.  It may be populated in whatever way is useful to the client.
      - name: reimbursement_code_unscrubbed
        description: >
            Pricing method used to adjudicate claim, as specified in the plan data source.  This value is scrubbed into the reimbursement_code column.  
      - name: ingr_cost_amount
        description: >
            Ingredient cost amount.  State Medicaid programs reimburse pharmacies for prescription drugs based on the ingredient costs for the drug and a dispensing fee for filling the prescription.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: dispensing_fee_amount
        description: >
            Dispensing fee amount.  This is a fee charged by the pharmacy to fill a prescription.  Dispensing fees vary by pharmacy, geographic location, and type of medication, where the fee may be higher for compound or more complex medications.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: awp_amount
        description: >
            Average wholesale price amount. AWP is a benchmark for pricing and reimbursement of prescription drugs, published by commercial publishers of drug pricing data. It was initially intended to represent the average price that wholesalers used to sell medications to providers, such as physicians, pharmacies, and other customers. And reimbursement amounts are often based on AWP minus some percentage.  However, at present, published AWP values are generally considered greatly inflated.
      - name: lics_subsidy_amount
        description: >
            Medicare prescription drug benefiit subsidy for low-income individuals.  A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: retro_lics_subsidy_amount
        description: >
            Retroactive Medicare prescription drug benefiit subsidy for low-income individuals. A negative value in this column indicates that this row represents a reversal or negative adjustment.  
      - name: retro_lics_code
        description: >
            The retroactive low-income subsidy code., the LICS level the member falls into (e.g. LIS Cat 1, 2, 3).  This value is derived from retro_lics_code_unscrubbed based on mapping in the lookup.plan_retro_lics_code table in Staging.  
      - name: retro_lics_code_unscrubbed
        description: >
            The retroactive low-income subsidy code, as specified in the plan data source.  This value is scrubbed into the retro_lics_code column.  
      - name: member_id
        description: >
            QDW member ID of the member for whom the drug was dispensed.
      - name: orig_member_id
        description: >
            Member ID, as specified in the plan data source, of the member for whom the drug was dispensed.
      - name: orig_authorization_id
        description: >
            Authorization ID, as specified in the plan data source.
      - name: adjudicated_lob_id
        description: >
            QDW line of business ID for the line of business of the insurance product in which this claim was processed. 
      - name: orig_adjudicated_lob_id
        description: >
            Line of business ID, as specified in the plan data source, of the insurance product in which this claim was processed.
      - name: adjudicated_payor_id
        description: >
            QDW payor ID for the insurance product in which this claim was processed. 
      - name: orig_adjudicated_payor_id
        description: >
            Payer ID, as specified in the plan data source, of the insurance product in which this claim was processed.
      - name: pcp_provider_id
        description: >
            QDW plan provider ID of the member's primary care provider at the time the medication was filled.
      - name: orig_pcp_provider_id
        description: >
            Plan provider ID, as specified in the plan data source, of the provider who was the primary care provider for the member to whom the drug was dispensed.
      - name: adjudicated_site_id
        description: >
            QDW plan site ID of the clinical site to which the member was assigned for purposes of managed care when the prescription was filled.  This value is used to populate the LocationID in rpt.Event.
      - name: orig_adjudicated_site_id
        description: >
            Plan site ID, as specified in the plan data source, of the clinical site to which the member was assigned for purposes of managed care when the service covered on this prescription claim was provided.
      - name: pharmacy_npi
        description: >
            National Provider Identifier (NPI) code of the pharmacy that dispensed the drug.
      - name: payee_name
        description: >
            Payee Check Name; the payee name to be printed on the check.
      - name: payee_type
        description: >
            Code indicating the type of entity to whom the claim was paid.  Valid values are '1' (pharmacy), '2' (subscriber), and '3' (mail order).  This value is derived from the value in payee_type_unscrubbed, using mappings in lookup.plan_payee_type in Staging.  If a mapping is not found, the value is set to 'Needs Update'.  
      - name: payee_type_unscrubbed
        description: >
            Type of entity to whom the claim was paid, as specified in the plan data source.  This value is scrubbed into the payee_type column. 
      - name: prescriber_id
        description: >
            QDW plan provider ID of the provider who prescribed the medication.  This link makes the name of the prescribing provider visible in reports so that the care management team knows who to reach out to, for example when they see an unfamiliar prescription.  This value is derived from the value in orig_prescriber_id.  
      - name: orig_prescriber_id
        description: >
            Plan provider ID, as specified in the plan data source, of the provider who prescribed the medication.  This value is scrubbed into the prescriber_id column.
      - name: prescriber_npi
        description: >
            National Provider Identifier (NPI) code of the provider who prescribed the medication.  
      - name: prescriber_dea_no
        description: >
            Drug Enforcement Agency (DEA) number of the provider who prescribed the medication.  
      - name: submit_type_code
        description: >
            Method in which the prescription was submitted, e.g. 'E' (Electronic), 'T' (Tape), or 'P' (Paper).  This value is derived from the submit_type_code_unscrubbed column based on mapping in the lookup.plan_submit_type_code table in Staging. 
      - name: submit_type_code_unscrubbed
        description: >
            Method in which the prescription was submitted, as specified in the plan data source.  This value is scrubbed into the submit_type_code column.
      - name: received_date
        description: >
            Date the claim was received by the plan.  This value is used in Arcadia Analytics logic that identifies the most recent claim for a member.
      - name: source_id
        description: >
            QDW source ID of the plan data source from which this record was obtained.
      - name: orig_source_id
        description: >
            QDW source ID in character format of the plan data source from which this record was obtained.
      - name: insert_timestamp
        description: >
            Date and time when the row was first inserted into the QDW.
      - name: update_timestamp
        description: >
            Date and time when the row was last updated in the QDW.
      - name: create_timestamp
        description: >
            Date and time when the row was first inserted into the plan data source.
      - name: modify_timestamp
        description: >
            Date and time when the row was last updated in the plan data source.
      - name: created_by
        description: >
            User who first inserted the row into the plan data source, as specified by a user ID known to the plan data source.
      - name: modified_by
        description: >
            User who most recently updated the row in the plan data source, as specified by a user ID known to the plan data source.
      - name: delete_ind
        description: >
            Indicates if the record is marked as deleted, either because it was deleted in the plan data source, or because the connector query changed in a way that makes the record no longer valid.  Values are Y (deleted) and N (not deleted).  If the value is 'Y' then the row should be excluded from all queries.
      - name: loaded_from_file
        description: >
            Name of the file from which this particular record was first loaded, usually a CSV file. The following pieces of information may be embedded in this file name: date and time of the extract, client and source IDs, and connector query version.  
      - name: end_date
        description: >
            End date of the prescription, the last date on which the member presumably will be taking the medication dispensed in this fill.  This is a calculated column.  The algorithm for calculating it, as found in the plan_claim_rx CREATE TABLE statement, converts the days_supply string value to numeric and adds it to the prescription_date.  Note that this end_date only covers this particular fill; if refills are available they are not considered in calculating this end_date.  This value is used in the rpt.event table.  Certain measures use this value to calculate the number of days that the patient was taking the medication.
      - name: atRiskFlag
        description: >
            A 0/1 indicator that, in the given month, this member is considered "At Risk" for a payer contract. This column can be summed to generate aggregate numbers of at-risk patients, or used as a filter. 
      - name: formulary_desc
        description: >
            Name of the formulary tier of a drug, if it is formulary.
      - name: pharmacy_service_type_id   
        description: >
            CMS code indicating the type of pharmacy service provided.
      - name: pharmacy_service_type_desc 
        description: >
           CMS provided description of the type of pharmacy service provided.