version: 2

models:
  - name: v_plan_product
    description: > 
        This table contains a master list of specific insurance plans or benefit packages into which members are enrolled and through which claims are paid. Claims are linked to products as part of the plan's adjudication process. Any product ID referenced in the v_plan_claim_line, v_plan_claim_rx, or v_plan_member_elig table must be included in this list.
    data_tests:
      - not_empty:
          meta:
            requirement: [ 'FDR-1849' ]
    columns:
      - name: product_id
        description: >
          QDW product ID; primary key for this table.  This is generated by Arcadia.
      - name: product_desc
        description: >
          Name of the product.  This name is visible in the Arcadia Analytics front end in
          the 'Member Products' filter.  Because this is visible to users, it is best if
          this name is brief (max 35 chars), easy to read, and distinct from the values
          for other products.
      - name: product_no
        description: >
          Product number.  For some plans, there is an externally-facing product number
          that would be visible for example on a member's insurance card.  This is not a
          functional field and could be null.
      - name: lob_id
        description: >
          QDW line of business ID of the line of business to which this product belongs.
          This is populated manually during the implementation process as seed data.
          However, as new product IDs get added to plan_product, it is possible that the
          LOB ID would not get populated.
      - name: orig_lob_id
        description: >
          Line of business ID, as specified in the plan data source, of the line of
          business to which this product belongs.
      - name: orig_source_id
        description: >
          QDW source ID in character format of the plan data source from which this record
          was obtained.
      - name: source_id
        description: >
          QDW source ID of the plan data source from which this record was obtained.
        data_tests:
          - not_null:
              meta:
                requirement: [ 'FDR-728' ]
          - relationships:
              to: ref('v_plan_source')
              field: source_id
              meta:
                requirement: [ 'FDR-728' ]
      - name: orig_product_id
        description: >
          ID of the product row in the Staging database, used to tie back to the plan data
          source.  This is created by the connector query or direct feed that loads the
          row from a given source, and is derived from plan data source column(s) to
          uniquely identify a row. For a given source, one original ID corresponds to one
          and only one QDW ID for this entity.  The same original ID value could be found
          on more than one row if the rows are derived from different sources.
      - name: insert_timestamp
        description: >
          Date and time when the row was first inserted into the QDW.
      - name: update_timestamp
        description: >
          Date and time when the row was last updated in the QDW.
      - name: create_timestamp
        description: >
          Date and time when the row was first inserted into the plan data source.
      - name: modify_timestamp
        description: >
          Date and time when the row was last updated in the plan data source.
      - name: created_by
        description: >
          User who first inserted the row into the plan data source, as specified by a
          user ID known to the plan data source.
      - name: modified_by
        description: >
          User who most recently updated the row in the plan data source, as specified by
          a user ID known to the plan data source.
      - name: delete_ind
        description: >
          Indicates if the record is marked as deleted, either because it was deleted in
          the plan data source, or because the connector query changed in a way that makes
          the record no longer valid.  Values are 'Y' (deleted) and 'N' (not
          deleted).  If the value is 'Y' then the row should be excluded from all queries.
      - name: loaded_from_file
        description: >
          Name of the file from which this particular record was first loaded, usually a
          CSV file. The following pieces of information may be embedded in this file name:
          date and time of the extract, client and source IDs, and connector query
          version.